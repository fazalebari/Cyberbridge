import requests
import socket
import whois
import json
import os
from bs4 import BeautifulSoup

def banner():
    print("""
    ===================================
      Kali Linux Information Gathering
    ===================================
    """)

def ip_lookup(domain):
    try:
        ip = socket.gethostbyname(domain)
        print(f"IP Address of {domain}: {ip}")
        return ip
    except Exception as e:
        print(f"Error during IP lookup: {e}")

def port_scan(ip):
    print(f"Scanning ports for {ip}...")
    common_ports = [21, 22, 23, 25, 53, 80, 110, 443]
    for port in common_ports:
        try:
            with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
                s.settimeout(1)
                result = s.connect_ex((ip, port))
                if result == 0:
                    print(f"Port {port}: OPEN")
        except Exception as e:
            print(f"Error scanning port {port}: {e}")

def whois_lookup(domain):
    try:
        w = whois.whois(domain)
        print(f"WHOIS information for {domain}:")
        print(w)
    except Exception as e:
        print(f"Error during WHOIS lookup: {e}")

def shodan_lookup(api_key, ip):
    try:
        url = f"https://api.shodan.io/shodan/host/{ip}?key={api_key}"
        response = requests.get(url)
        data = response.json()
        print(f"Shodan data for {ip}:")
        print(json.dumps(data, indent=2))
    except Exception as e:
        print(f"Error during Shodan lookup: {e}")

def web_scrape(url):
    try:
        response = requests.get(url)
        soup = BeautifulSoup(response.text, 'html.parser')
        print(f"Page Title: {soup.title.string}")
        print("Links found on the page:")
        for link in soup.find_all('a', href=True):
            print(link['href'])
    except Exception as e:
        print(f"Error during web scraping: {e}")

if __name__ == "__main__":
    banner()
    target = input("Enter the target domain or IP: ").strip()
    api_key = input("Enter your Shodan API key (optional): ").strip()

    if not target:
        print("Target is required!")
    else:
        ip = ip_lookup(target)
        if ip:
            port_scan(ip)
            whois_lookup(target)
            if api_key:
                shodan_lookup(api_key, ip)

        # Web scraping for a given website
        scrape_option = input("Do you want to scrape the target's website? (y/n): ").strip().lower()
        if scrape_option == 'y':
            web_scrape(f"http://{target}")
